<!DOCTYPE html>
<html lang="en">

<head>
    <title>Image Spinner</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
        }

        #spinner-container {
            position: relative;
            width: 80vmin;
            height: 80vmin;
        }

        #spinner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: absolute;
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.83, 0.67);
        }

        .image-segment {
            position: absolute;
            transform-origin: center;
        }

        #indicator {
            position: absolute;
            bottom: -5%;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 2vmin solid transparent;
            border-right: 2vmin solid transparent;
            border-top: 4vmin solid red;
        }

        #fullscreen-btn {
            position: fixed;
            bottom: 2%;
            right: 2%;
            background: white;
            padding: 0.5em 1em;
            border: none;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="spinner-container">
        <div id="spinner"></div>
        <div id="indicator"></div>
    </div>
    <button id="fullscreen-btn" onclick="toggleFullscreen()">Fullscreen</button>

    <script>
        const spinner = document.getElementById('spinner');
        let angle = 0;

        async function loadImages() {
            const images = await fetchImages('./');
            const n = images.length;
            const radius = spinner.clientWidth / 2;

            images.forEach((imgSrc, i) => {
                const img = document.createElement('img');
                img.src = imgSrc;
                img.className = 'image-segment';

                const theta = (i * 2 * Math.PI) / n;
                const x = radius * Math.cos(theta);
                const y = radius * Math.sin(theta);

                img.style.left = `${50 + (x / radius) * 50}%`;
                img.style.top = `${50 + (y / radius) * 50}%`;
                img.style.transform = `translate(-50%, -50%) rotate(${theta + Math.PI / 2}rad)`;
                spinner.appendChild(img);
            });
        }

        async function fetchImages(path) {
            try {
                const response = await fetch(path);
                const text = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');
                return Array.from(doc.links)
                    .filter(link => link.href.endsWith('.png'))
                    .map(link => `${path}/${link.href.split('/').pop()}`);
            } catch {
                return [];
            }
        }

        function spin() {
            angle += 720 + Math.random() * 360;
            spinner.style.transform = `rotate(${angle}deg)`;
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        spinner.addEventListener('click', spin);
        loadImages();
    </script>
</body>

</html>
